<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Docs</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
</head>
<body>
  <div id="v-app">
  <topnav></topnav>
  <login></login>
  <signup></signup>
  <doclist></doclist>



  <template id="topnav-template">
    <nav class="navbar navbar-default navbar-static-top">
      <div class="btn-group" v-if="!$parent.logsign">
          <button @click="showLogin">LogIn</button>
          <button @click="showSignup">SignUp</button>
      </div>
      <div class="btn-group" v-if=$parent.docList>
        Logged-in user: {{$parent.email}}
      </div>
    </nav>
  </template>

  <template id="login-template">
    <div class="login-grp"  v-if="$parent.login">
      <div class="row">
        <div class="col-12 col-6-tablet push-3-tablet text-center">
          <h1 class="font-100">Welcome Back</h1>
        </div>
      
        <div class="col-12 col-6-tablet push-3-tablet col-4-desktop push-4-desktop text-center">
          <form id=formLogin>
            <fieldset>
              <input type="email" v-model="$parent.email" placeholder="email">
            </fieldset>
            <fieldset>
              <input type="password" v-model="$parent.password" placeholder="password">
            </fieldset>
            <button type="submit" class="button button-primary" v-on:click.prevent="$parent.doLogin">
              Login
            </button>
          </form>
        </div>
      </div>
    </div>
  </template>

  <template id="signup-template">
    <div class="row" v-if="$parent.signup">
      <div class="col-12 col-6-tablet push-3-tablet text-center">
        <h1 class="font-100">Create an Account</h1>
      </div>
    
        <div class="col-12 col-6-tablet push-3-tablet col-4-desktop push-4-desktop text-center">
          <form class="form">
            <fieldset>
              <input class="block" type="email" v-model="$parent.email" placeholder="email">
            </fieldset>
            <fieldset>
              <input class="block" type="password" v-model="$parent.password" placeholder="password">
            </fieldset>
            <button type="submit" class="button button-primary" v-on:click.prevent="doSignup">
              Signup
            </button>
          </form>
        </div>
      </div>   
  </template>

  <template id="doclist-template">
    <div class="doclist-grp" v-if="$parent.docList">
      <table class="table table-striped">
        <tr>
            <th>Id</th>
            <th>Title</th>
            <th>Author</th>
            <th>Text</th>
        </tr>
        <tr v-for="document in $parent.documents" is="document" :document="document"></tr>
        <p>
          <h2>Here's a list of all your documents.</h2>
           <label for="file">Add a document</label>
          <input type="file" name="file" @change="$parent.onFileChange">
        </p>
      </table>
    </div>   
  </template>

  <template id="document-template">
    <tr>
      <td>
          {{document.id}}
      </td>
      <td class="col-md-6">
          <input v-if="document.editing" v-model="document.title" class="form-control">
          </input>
          <!--in other occasions show the story plot-->
              <span v-else>
                  {{document.title}}
              </span>
      </td>
      <td>
          <input v-if="document.editing" v-model="document.author" class="form-control">
          </input>
          <!--in other occasions show the story writer-->
              <span v-else>
                  {{document.author}}
              </span>
      </td>
      <td>
          <input v-if="document.editing" v-model="document.text" class="form-control">
          </input>
          <!--in other occasions show the story writer-->
              <span v-else>
                  {{document.text}}
              </span>
      </td>
      <td>   
        <div class="btn-group" v-if="!document.editing">
            <button @click="editDocument(document)" class="btn btn-default">Edit</button>
            <button @click="deleteDocument(document)" class="btn btn-danger">Delete</button>
            <button @click="downloadDocument(document)" class="btn btn-default">Download</button>
        </div>
        <div class="btn-group" v-else>
            <!--If the document is taken from the db then it will have an id-->
            <button v-if="document.id" class="btn btn-primary" @click="updateDocument(document)">Update Document
            </button>
            <!--If the document is new we want to store it-->
            <button v-else class="btn btn-success" @click="storeDocument(document)">Save New Document</button>
            <!--Always show cancel-->
            <button @click="document.editing=false" class="btn btn-default">Cancel</button>
        </div>
      </td>
    </tr>
  </template>
  </div>
<script src="http://cdnjs.cloudflare.com/ajax/libs/vue/1.0.26/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/0.9.3/vue-resource.js"></script>
<script src="//cdn.rawgit.com/feathersjs/feathers-client/v1.5.1/dist/feathers.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="https://fastcdn.org/FileSaver.js/1.1.20151003/FileSaver.js"></script>
<script src='/js/app.js' type="text/javascript"></script>
</body>
</html>